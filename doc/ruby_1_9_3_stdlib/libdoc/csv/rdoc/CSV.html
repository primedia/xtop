<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <!-- classpage -- >
    <!-- RD version: 0.26.0  -->
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
  
  <meta content="2014-04-26 10:49:30 -0700" http-equiv="change-date" />
  <!-- rel_prefix  = ''  ENV['RDOC_FOR_WEBSITE']   = false-->
    
    
    
  <!-- rel_prefix = '.'   asset_rel_prefix = ''  --> 
  <title>Class: CSV (Ruby 1.9.3) </title>
  <!-- link rel="stylesheet" href=".css/obf.css"  -->
  <link rel="stylesheet" href="css/inuit.css" >
  <link rel="stylesheet" href="css/grid.inuit.css" >
  <link rel="stylesheet" href="css/2011.css" type="text/css" >
  <link rel="stylesheet" href="css/rdoc.css" type="text/css" >

  <script src="/js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/rubydoc.js" type="text/javascript" charset="utf-8"></script> 

 
<script src="/js/highlight.min.js"></script>
<script> 
  hljs.tabReplace = '  ';
  hljs.initHighlightingOnLoad();
  </script> 

  <style type='text/css'>

    #vulns-alert #vulns{
      background-color: #c33 ! important;
      width: 100%;
      text-align: center;
   }
   
   #vulns-alert #vulns a {
    color: #F99 ! important;
   }
 </style>

</head>

<body id="top" class="class rdocstar">
<div id='actionbar' >
<div class='wrapper'>
  <ul class='grids g0'></ul>
</div>
<span id='vulns-alert'></span>
</div> <!-- end action bar -->
 <div class='wrapper'>
  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
          
          
          <!-- br><a id='alternateFormatLink' class='rotate' href="#" onclick='matchingYardUrl()'>YARD version</a -->
          
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul id='file-metadata'>

          
          
          
          <li class='in-file'>csv.rb</li>      
            
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link"><a href="Object.html">Object</a></p>
        
      </div>
      

      

      
      <!-- Namespace Contents -->
      <div id="namespace-list-section" class="section">
        <h3 class="section-header">Namespace</h3>
        <ul class="link-list">
          
          <li><span class="type">CLASS</span> <a href="CSV/MalformedCSVError.html">CSV::MalformedCSVError</a></li>
          
          <li><span class="type">CLASS</span> <a href="CSV/Row.html">CSV::Row</a></li>
          
          <li><span class="type">CLASS</span> <a href="CSV/Table.html">CSV::Table</a></li>
          
        </ul>
      </div>
      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-dump">::dump</a></li>
          
          <li><a href="#method-c-filter">::filter</a></li>
          
          <li><a href="#method-c-foreach">::foreach</a></li>
          
          <li><a href="#method-c-generate">::generate</a></li>
          
          <li><a href="#method-c-generate_line">::generate_line</a></li>
          
          <li><a href="#method-c-instance">::instance</a></li>
          
          <li><a href="#method-c-load">::load</a></li>
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-c-open">::open</a></li>
          
          <li><a href="#method-c-parse">::parse</a></li>
          
          <li><a href="#method-c-parse_line">::parse_line</a></li>
          
          <li><a href="#method-c-read">::read</a></li>
          
          <li><a href="#method-c-readlines">::readlines</a></li>
          
          <li><a href="#method-c-table">::table</a></li>
          
          <li><a href="#method-i-3C-3C">#<<</a></li>
          
          <li><a href="#method-i-add_row">#add_row</a></li>
          
          <li><a href="#method-i-convert">#convert</a></li>
          
          <li><a href="#method-i-converters">#converters</a></li>
          
          <li><a href="#method-i-each">#each</a></li>
          
          <li><a href="#method-i-force_quotes-3F">#force_quotes?</a></li>
          
          <li><a href="#method-i-gets">#gets</a></li>
          
          <li><a href="#method-i-header_convert">#header_convert</a></li>
          
          <li><a href="#method-i-header_converters">#header_converters</a></li>
          
          <li><a href="#method-i-header_row-3F">#header_row?</a></li>
          
          <li><a href="#method-i-headers">#headers</a></li>
          
          <li><a href="#method-i-inspect">#inspect</a></li>
          
          <li><a href="#method-i-puts">#puts</a></li>
          
          <li><a href="#method-i-read">#read</a></li>
          
          <li><a href="#method-i-readline">#readline</a></li>
          
          <li><a href="#method-i-readlines">#readlines</a></li>
          
          <li><a href="#method-i-return_headers-3F">#return_headers?</a></li>
          
          <li><a href="#method-i-rewind">#rewind</a></li>
          
          <li><a href="#method-i-shift">#shift</a></li>
          
          <li><a href="#method-i-skip_blanks-3F">#skip_blanks?</a></li>
          
          <li><a href="#method-i-unconverted_fields-3F">#unconverted_fields?</a></li>
          
          <li><a href="#method-i-write_headers-3F">#write_headers?</a></li>
          
        </ul>
      </div>
      

      
      <!-- Included Modules -->
      <div id="includes-section" class="section">
        <h3 class="section-header">Included Modules</h3>
        <ul class="link-list">
        
        
          <li><span class="include">Enumerable</span></li>
        
        
        </ul>
      </div>
      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="./images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
          
          
          
          <li><a href="./Array.html">Array</a></li>
        
          
          
          <li><a href="./CSV.html">CSV</a></li>
        
          
          
          <li><a href="./CSV/MalformedCSVError.html">CSV::MalformedCSVError</a></li>
        
          
          
          <li><a href="./CSV/Row.html">CSV::Row</a></li>
        
          
          
          <li><a href="./CSV/Table.html">CSV::Table</a></li>
        
          
          
          <li><a href="./Object.html">Object</a></li>
        
          
          
          <li><a href="./String.html">String</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div> <!-- metadata -->
  <div class='adzbox'  id="azk83167">
    
  </div> 
  <div id="documentation">
    <h1 class="class">CSV</h1>

    <div id="description" class="description">
      
<p>This class provides a complete interface to <a href="CSV.html">CSV</a>
files and data.  It offers tools to enable you to read and write to and
from Strings or IO objects, as needed.</p>

<h2 id="class-CSV-label-Reading">Reading<span><a href="#class-CSV-label-Reading">&para;</a> <a href="#documentation">&uarr;</a></span></h2>

<h3 id="class-CSV-label-From+a+File">From a File<span><a href="#class-CSV-label-From+a+File">&para;</a> <a href="#documentation">&uarr;</a></span></h3>

<h4 id="class-CSV-label-A+Line+at+a+Time">A Line at a Time<span><a href="#class-CSV-label-A+Line+at+a+Time">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<pre class="ruby"><span class="ruby-constant">CSV</span>.<span class="ruby-identifier">foreach</span>(<span class="ruby-string">&quot;path/to/file.csv&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
  <span class="ruby-comment"># use row here...</span>
<span class="ruby-keyword">end</span>
</pre>

<h4 id="class-CSV-label-All+at+Once">All at Once<span><a href="#class-CSV-label-All+at+Once">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<pre>arr_of_arrs = CSV.read(&quot;path/to/file.csv&quot;)</pre>

<h3 id="class-CSV-label-From+a+String">From a <a href="String.html">String</a><span><a href="#class-CSV-label-From+a+String">&para;</a> <a href="#documentation">&uarr;</a></span></h3>

<h4 id="class-CSV-label-A+Line+at+a+Time">A Line at a Time<span><a href="#class-CSV-label-A+Line+at+a+Time">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<pre class="ruby"><span class="ruby-constant">CSV</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-string">&quot;CSV,data,String&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
  <span class="ruby-comment"># use row here...</span>
<span class="ruby-keyword">end</span>
</pre>

<h4 id="class-CSV-label-All+at+Once">All at Once<span><a href="#class-CSV-label-All+at+Once">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<pre>arr_of_arrs = CSV.parse(&quot;CSV,data,String&quot;)</pre>

<h2 id="class-CSV-label-Writing">Writing<span><a href="#class-CSV-label-Writing">&para;</a> <a href="#documentation">&uarr;</a></span></h2>

<h3 id="class-CSV-label-To+a+File">To a File<span><a href="#class-CSV-label-To+a+File">&para;</a> <a href="#documentation">&uarr;</a></span></h3>

<pre class="ruby"><span class="ruby-constant">CSV</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">&quot;path/to/file.csv&quot;</span>, <span class="ruby-string">&quot;wb&quot;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">csv</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-string">&quot;row&quot;</span>, <span class="ruby-string">&quot;of&quot;</span>, <span class="ruby-string">&quot;CSV&quot;</span>, <span class="ruby-string">&quot;data&quot;</span>]
  <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-string">&quot;another&quot;</span>, <span class="ruby-string">&quot;row&quot;</span>]
  <span class="ruby-comment"># ...</span>
<span class="ruby-keyword">end</span>
</pre>

<h3 id="class-CSV-label-To+a+String">To a <a href="String.html">String</a><span><a href="#class-CSV-label-To+a+String">&para;</a> <a href="#documentation">&uarr;</a></span></h3>

<pre class="ruby"><span class="ruby-identifier">csv_string</span> = <span class="ruby-constant">CSV</span>.<span class="ruby-identifier">generate</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">csv</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-string">&quot;row&quot;</span>, <span class="ruby-string">&quot;of&quot;</span>, <span class="ruby-string">&quot;CSV&quot;</span>, <span class="ruby-string">&quot;data&quot;</span>]
  <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-string">&quot;another&quot;</span>, <span class="ruby-string">&quot;row&quot;</span>]
  <span class="ruby-comment"># ...</span>
<span class="ruby-keyword">end</span>
</pre>

<h2 id="class-CSV-label-Convert+a+Single+Line">Convert a Single Line<span><a href="#class-CSV-label-Convert+a+Single+Line">&para;</a> <a href="#documentation">&uarr;</a></span></h2>

<pre>csv_string = [&quot;CSV&quot;, &quot;data&quot;].to_csv   # to CSV
csv_array  = &quot;CSV,String&quot;.parse_csv   # from CSV</pre>

<h2 id="class-CSV-label-Shortcut+Interface">Shortcut Interface<span><a href="#class-CSV-label-Shortcut+Interface">&para;</a> <a href="#documentation">&uarr;</a></span></h2>

<pre class="ruby"><span class="ruby-constant">CSV</span>             { <span class="ruby-operator">|</span><span class="ruby-identifier">csv_out</span><span class="ruby-operator">|</span> <span class="ruby-identifier">csv_out</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">%w{my data here}</span> }  <span class="ruby-comment"># to $stdout</span>
<span class="ruby-constant">CSV</span>(<span class="ruby-identifier">csv</span> = <span class="ruby-string">&quot;&quot;</span>)   { <span class="ruby-operator">|</span><span class="ruby-identifier">csv_str</span><span class="ruby-operator">|</span> <span class="ruby-identifier">csv_str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">%w{my data here}</span> }  <span class="ruby-comment"># to a String</span>
<span class="ruby-constant">CSV</span>(<span class="ruby-identifier">$stderr</span>)    { <span class="ruby-operator">|</span><span class="ruby-identifier">csv_err</span><span class="ruby-operator">|</span> <span class="ruby-identifier">csv_err</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">%w{my data here}</span> }  <span class="ruby-comment"># to $stderr</span>
<span class="ruby-constant">CSV</span>(<span class="ruby-identifier">$stdin</span>)     { <span class="ruby-operator">|</span><span class="ruby-identifier">csv_in</span><span class="ruby-operator">|</span>  <span class="ruby-identifier">csv_in</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">row</span> } }  <span class="ruby-comment"># from $stdin</span>
</pre>

<h2 id="class-CSV-label-Advanced+Usage">Advanced Usage<span><a href="#class-CSV-label-Advanced+Usage">&para;</a> <a href="#documentation">&uarr;</a></span></h2>

<h3 id="class-CSV-label-Wrap+an+IO+Object">Wrap an IO <a href="Object.html">Object</a><span><a href="#class-CSV-label-Wrap+an+IO+Object">&para;</a> <a href="#documentation">&uarr;</a></span></h3>

<pre>csv = CSV.new(io, options)
# ... read (with gets() or each()) from and write (with &lt;&lt;) to csv here ...</pre>

<h2 id="class-CSV-label-CSV+and+Character+Encodings+%28M17n+or+Multilingualization%29"><a href="CSV.html">CSV</a> and Character Encodings (M17n or Multilingualization)<span><a href="#class-CSV-label-CSV+and+Character+Encodings+%28M17n+or+Multilingualization%29">&para;</a> <a href="#documentation">&uarr;</a></span></h2>

<p>This new <a href="CSV.html">CSV</a> parser is m17n savvy.  The parser works
in the Encoding of the IO or <a href="String.html">String</a> object being
read from or written to.  Your data is never transcoded (unless you ask
Ruby to transcode it for you) and will literally be parsed in the Encoding
it is in.  Thus <a href="CSV.html">CSV</a> will return Arrays or Rows of
Strings in the Encoding of your data.  This is accomplished by transcoding
the parser itself into your Encoding.</p>

<p>Some transcoding must take place, of course, to accomplish this
multiencoding support.  For example, <code>:col_sep</code>,
<code>:row_sep</code>, and <code>:quote_char</code> must be transcoded to
match your data.  Hopefully this makes the entire process feel transparent,
since CSV’s defaults should just magically work for you data.  However, you
can set these values manually in the target Encoding to avoid the
translation.</p>

<p>It’s also important to note that while all of CSV’s core parser is now
Encoding agnostic, some features are not.  For example, the built-in
converters will try to transcode data to UTF-8 before making conversions.
Again, you can provide custom converters that are aware of your Encodings
to avoid this translation.  It’s just too hard for me to support native
conversions in all of Ruby’s Encodings.</p>

<p>Anyway, the practical side of this is simple:  make sure IO and <a
href="String.html">String</a> objects passed into <a
href="CSV.html">CSV</a> have the proper Encoding set and everything should
just work. <a href="CSV.html">CSV</a> methods that allow you to open IO
objects (CSV::foreach(), <a href="CSV.html#method-c-open">::open</a>, <a
href="CSV.html#method-c-read">::read</a>, and <a
href="CSV.html#method-c-readlines">::readlines</a>) do allow you to specify
the Encoding.</p>

<p>One minor exception comes when generating <a href="CSV.html">CSV</a> into a
<a href="String.html">String</a> with an Encoding that is not ASCII
compatible.  There’s no existing data for <a href="CSV.html">CSV</a> to use
to prepare itself and thus you will probably need to manually specify the
desired Encoding for most of those cases.  It will try to guess using the
fields in a row of output though, when using <a
href="CSV.html#method-c-generate_line">::generate_line</a> or <a
href="Array.html#method-i-to_csv">Array#to_csv</a>.</p>

<p>I try to point out any other Encoding issues in the documentation of
methods as they come up.</p>

<p>This has been tested to the best of my ability with all non-“dummy”
Encodings Ruby ships with.  However, it is brave new code and may have some
bugs. Please feel free to <a
href="mailto:james@grayproductions.net">report</a> any issues you find with
it.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      
      <!-- Constants -->
      <div id="constants-list" class="section">
        <h3 class="section-header">Constants</h3>
        <dl>
        
          <dt><a name="ConverterEncoding">ConverterEncoding</a></dt>
          
          <dd class="description"><p>The encoding used by all converters.</p></dd>
          
        
          <dt><a name="Converters">Converters</a></dt>
          
          <dd class="description"><p>This Hash holds the built-in converters of <a href="CSV.html">CSV</a> that
can be accessed by name. You can select <a
href="CSV.html#Converters">Converters</a> with <a
href="CSV.html#method-i-convert">#convert</a> or through the
<code>options</code> Hash passed to <a
href="CSV.html#method-c-new">::new</a>.</p>
<dl class="rdoc-list note-list"><dt><strong><code>:integer</code></strong>
<dd>
<p>Converts any field Integer() accepts.</p>
</dd><dt><strong><code>:float</code></strong>
<dd>
<p>Converts any field Float() accepts.</p>
</dd><dt><strong><code>:numeric</code></strong>
<dd>
<p>A combination of <code>:integer</code> and <code>:float</code>.</p>
</dd><dt><strong><code>:date</code></strong>
<dd>
<p>Converts any field Date::parse() accepts.</p>
</dd><dt><strong><code>:date_time</code></strong>
<dd>
<p>Converts any field DateTime::parse() accepts.</p>
</dd><dt><strong><code>:all</code></strong>
<dd>
<p>All built-in converters.  A combination of <code>:date_time</code> and
<code>:numeric</code>.</p>
</dd></dl>

<p>All built-in converters transcode field data to UTF-8 before attempting a
conversion.  If your data cannot be transcoded to UTF-8 the conversion will
fail and the field will remain unchanged.</p>

<p>This Hash is intentionally left unfrozen and users should feel free to add
values to it that can be accessed by all <a href="CSV.html">CSV</a>
objects.</p>

<p>To add a combo field, the value should be an <a href="Array.html">Array</a>
of names.  Combo fields can be nested with other combo fields.</p></dd>
          
        
          <dt><a name="DEFAULT_OPTIONS">DEFAULT_OPTIONS</a></dt>
          
          <dd class="description"><p>The options used when no overrides are given by calling code.  They are:</p>
<dl class="rdoc-list note-list"><dt><strong><code>:col_sep</code></strong>
<dd>
<p><code>&quot;,&quot;</code></p>
</dd><dt><strong><code>:row_sep</code></strong>
<dd>
<p><code>:auto</code></p>
</dd><dt><strong><code>:quote_char</code></strong>
<dd>
<p><code>'&quot;'</code></p>
</dd><dt><strong><code>:field_size_limit</code></strong>
<dd>
<p><code>nil</code></p>
</dd><dt><strong><code>:converters</code></strong>
<dd>
<p><code>nil</code></p>
</dd><dt><strong><code>:unconverted_fields</code></strong>
<dd>
<p><code>nil</code></p>
</dd><dt><strong><code>:headers</code></strong>
<dd>
<p><code>false</code></p>
</dd><dt><strong><code>:return_headers</code></strong>
<dd>
<p><code>false</code></p>
</dd><dt><strong><code>:header_converters</code></strong>
<dd>
<p><code>nil</code></p>
</dd><dt><strong><code>:skip_blanks</code></strong>
<dd>
<p><code>false</code></p>
</dd><dt><strong><code>:force_quotes</code></strong>
<dd>
<p><code>false</code></p>
</dd></dl></dd>
          
        
          <dt><a name="DateMatcher">DateMatcher</a></dt>
          
          <dd class="description"><p>A Regexp used to find and convert some common Date formats.</p></dd>
          
        
          <dt><a name="DateTimeMatcher">DateTimeMatcher</a></dt>
          
          <dd class="description"><p>A Regexp used to find and convert some common DateTime formats.</p></dd>
          
        
          <dt><a name="FieldInfo">FieldInfo</a></dt>
          
          <dd class="description"><p>A <a href="CSV.html#FieldInfo">FieldInfo</a> Struct contains details about
a field’s position in the data source it was read from.  <a
href="CSV.html">CSV</a> will pass this Struct to some blocks that make
decisions based on field structure.  See CSV.convert_fields() for an
example.</p>
<dl class="rdoc-list note-list"><dt><strong><code>index</code></strong>
<dd>
<p>The zero-based index of the field in its row.</p>
</dd><dt><strong><code>line</code></strong>
<dd>
<p>The line of the data source this row is from.</p>
</dd><dt><strong><code>header</code></strong>
<dd>
<p>The header for the column, when available.</p>
</dd></dl></dd>
          
        
          <dt><a name="HeaderConverters">HeaderConverters</a></dt>
          
          <dd class="description"><p>This Hash holds the built-in header converters of <a
href="CSV.html">CSV</a> that can be accessed by name.  You can select <a
href="CSV.html#HeaderConverters">HeaderConverters</a> with <a
href="CSV.html#method-i-header_convert">#header_convert</a> or through the
<code>options</code> Hash passed to <a
href="CSV.html#method-c-new">::new</a>.</p>
<dl class="rdoc-list note-list"><dt><strong><code>:downcase</code></strong>
<dd>
<p>Calls downcase() on the header <a href="String.html">String</a>.</p>
</dd><dt><strong><code>:symbol</code></strong>
<dd>
<p>The header <a href="String.html">String</a> is downcased, spaces are
replaced with underscores, non-word characters are dropped, and finally
to_sym() is called.</p>
</dd></dl>

<p>All built-in header converters transcode header data to UTF-8 before
attempting a conversion.  If your data cannot be transcoded to UTF-8 the
conversion will fail and the header will remain unchanged.</p>

<p>This Hash is intetionally left unfrozen and users should feel free to add
values to it that can be accessed by all <a href="CSV.html">CSV</a>
objects.</p>

<p>To add a combo field, the value should be an <a href="Array.html">Array</a>
of names.  Combo fields can be nested with other combo fields.</p></dd>
          
        
          <dt><a name="VERSION">VERSION</a></dt>
          
          <dd class="description"><p>The version of the installed library.</p></dd>
          
        
        </dl>
      </div>
      

      
      <!-- Attributes -->
      <div id="attribute-method-details" class="method-section section">
        <h3 class="section-header">Attributes</h3>

        
        <div id="col_sep-attribute-method" class="method-detail">
          <a name="col_sep"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">col_sep</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description 245">
          
          <p>The encoded <code>:col_sep</code> used in parsing and writing.  See <a
href="CSV.html#method-c-new">::new</a> for details.</p>
          
          </div>
        </div>
        
        <div id="encoding-attribute-method" class="method-detail">
          <a name="encoding"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">encoding</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description 245">
          
          <p>The Encoding <a href="CSV.html">CSV</a> is parsing or writing in.  This
will be the Encoding you receive parsed data in and/or the Encoding data
will be written in.</p>
          
          </div>
        </div>
        
        <div id="field_size_limit-attribute-method" class="method-detail">
          <a name="field_size_limit"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">field_size_limit</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description 245">
          
          <p>The limit for field size, if any.  See <a
href="CSV.html#method-c-new">::new</a> for details.</p>
          
          </div>
        </div>
        
        <div id="lineno-attribute-method" class="method-detail">
          <a name="lineno"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">lineno</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description 245">
          
          <p>The line number of the last row read from this file.  Fields with nested
line-end characters will not affect this count.</p>
          
          </div>
        </div>
        
        <div id="quote_char-attribute-method" class="method-detail">
          <a name="quote_char"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">quote_char</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description 245">
          
          <p>The encoded <code>:quote_char</code> used in parsing and writing.  See <a
href="CSV.html#method-c-new">::new</a> for details.</p>
          
          </div>
        </div>
        
        <div id="row_sep-attribute-method" class="method-detail">
          <a name="row_sep"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">row_sep</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description 245">
          
          <p>The encoded <code>:row_sep</code> used in parsing and writing.  See <a
href="CSV.html#method-c-new">::new</a> for details.</p>
          
          </div>
        </div>
        
      </div><!-- attribute-method-details -->
      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="dump-method" class="method-detail ">
          <a name="method-c-dump"></a>

          
          <div class="method-heading">
            <span class="method-name">dump</span><span
              class="method-args">(ary_of_objs, io = "", options = Hash.new)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>This method allows you to serialize an <a href="Array.html">Array</a> of
Ruby objects to a <a href="String.html">String</a> or File of <a
href="CSV.html">CSV</a> data.  This is not as powerful as Marshal or YAML,
but perhaps useful for spreadsheet and database interaction.</p>

<p>Out of the box, this method is intended to work with simple data objects or
Structs.  It will serialize a list of instance variables and/or
Struct.members().</p>

<p>If you need need more complicated serialization, you can control the
process by adding methods to the class to be serialized.</p>

<p>A class method csv_meta() is responsible for returning the first row of the
document (as an <a href="Array.html">Array</a>).  This row is considered to
be a Hash of the form key_1,value_1,key_2,value_2,…  <a
href="CSV.html#method-c-load">::load</a> expects to find a class key with a
value of the stringified class name and <a
href="CSV.html#method-c-dump">::dump</a> will create this, if you do not
define this method.  This method is only called on the first object of the
<a href="Array.html">Array</a>.</p>

<p>The next method you can provide is an instance method called csv_headers().
This method is expected to return the second line of the document (again as
an <a href="Array.html">Array</a>), which is to be used to give each column
a header.  By default, <a href="CSV.html#method-c-load">::load</a> will set
an instance variable if the field header starts with an @ character or call
send() passing the header as the method name and the field value as an
argument.  This method is only called on the first object of the <a
href="Array.html">Array</a>.</p>

<p>Finally, you can provide an instance method called csv_dump(), which will
be passed the headers.  This should return an <a
href="Array.html">Array</a> of fields that can be serialized for this
object.  This method is called once for every object in the <a
href="Array.html">Array</a>.</p>

<p>The <code>io</code> parameter can be used to serialize to a File, and
<code>options</code> can be anything <a
href="CSV.html#method-c-new">::new</a> accepts.</p>
            

            
            <div class="method-source-code" id="dump-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1048</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-identifier">ary_of_objs</span>, <span class="ruby-identifier">io</span> = <span class="ruby-string">&quot;&quot;</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
  <span class="ruby-identifier">obj_template</span> = <span class="ruby-identifier">ary_of_objs</span>.<span class="ruby-identifier">first</span>

  <span class="ruby-identifier">csv</span> = <span class="ruby-identifier">new</span>(<span class="ruby-identifier">io</span>, <span class="ruby-identifier">options</span>)

  <span class="ruby-comment"># write meta information</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj_template</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">csv_meta</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
    <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-value">:class</span>, <span class="ruby-identifier">obj_template</span>.<span class="ruby-identifier">class</span>]
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># write headers</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">obj_template</span>.<span class="ruby-identifier">csv_headers</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
    <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">obj_template</span>.<span class="ruby-identifier">instance_variables</span>.<span class="ruby-identifier">sort</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">obj_template</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">ancestors</span>.<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">cls</span><span class="ruby-operator">|</span> <span class="ruby-identifier">cls</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\AStruct\b/</span> }
      <span class="ruby-identifier">headers</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">obj_template</span>.<span class="ruby-identifier">members</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">mem</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;#{mem}=&quot;</span> }.<span class="ruby-identifier">sort</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">headers</span>

  <span class="ruby-comment"># serialize each object</span>
  <span class="ruby-identifier">ary_of_objs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">csv_dump</span>(<span class="ruby-identifier">headers</span>)
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
      <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">var</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">var</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value">?@</span>
          <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-identifier">var</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">obj</span>[<span class="ruby-identifier">var</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>]]
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">io</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
    <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">string</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">close</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- dump-source -->
            
          </div>

          

          
        </div><!-- dump-method -->
      
        <div id="filter-method" class="method-detail ">
          <a name="method-c-filter"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">filter( options = Hash.new ) { |row| ... }</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">filter( input, options = Hash.new ) { |row| ... }</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">filter( input, output, options = Hash.new ) { |row| ... }</span>
            
          </div>
          
          
          <div>
  
            
            <p>This method is a convenience for building Unix-like filters for <a
href="CSV.html">CSV</a> data. Each row is yielded to the provided block
which can alter it as needed. After the block returns, the row is appended
to <code>output</code> altered or not.</p>

<p>The <code>input</code> and <code>output</code> arguments can be anything <a
href="CSV.html#method-c-new">::new</a> accepts (generally <a
href="String.html">String</a> or IO objects).  If not given, they default
to <code>ARGF</code> and <code>$stdout</code>.</p>

<p>The <code>options</code> parameter is also filtered down to <a
href="CSV.html#method-c-new">::new</a> after some clever key parsing.  Any
key beginning with <code>:in_</code> or <code>:input_</code> will have that
leading identifier stripped and will only be used in the
<code>options</code> Hash for the <code>input</code> object.  Keys starting
with <code>:out_</code> or <code>:output_</code> affect only
<code>output</code>.  All other keys are assigned to both objects.</p>

<p>The <code>:output_row_sep</code> <code>option</code> defaults to
<code>$INPUT_RECORD_SEPARATOR</code> (<code>$/</code>).</p>
            

            
            <div class="method-source-code" id="filter-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1164</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-comment"># parse options for input, output, or both</span>
  <span class="ruby-identifier">in_options</span>, <span class="ruby-identifier">out_options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>, {<span class="ruby-identifier">row_sep</span><span class="ruby-operator">:</span> <span class="ruby-identifier">$INPUT_RECORD_SEPARATOR</span>}
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Hash</span>
    <span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">case</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>
      <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\Ain(?:put)?_(.+)\Z/</span>
        <span class="ruby-identifier">in_options</span>[<span class="ruby-node">$1</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">value</span>
      <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\Aout(?:put)?_(.+)\Z/</span>
        <span class="ruby-identifier">out_options</span>[<span class="ruby-node">$1</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">value</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">in_options</span>[<span class="ruby-identifier">key</span>]  = <span class="ruby-identifier">value</span>
        <span class="ruby-identifier">out_options</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># build input and output wrappers</span>
  <span class="ruby-identifier">input</span>  = <span class="ruby-identifier">new</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span> <span class="ruby-operator">||</span> <span class="ruby-constant">ARGF</span>,    <span class="ruby-identifier">in_options</span>)
  <span class="ruby-identifier">output</span> = <span class="ruby-identifier">new</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">$stdout</span>, <span class="ruby-identifier">out_options</span>)

  <span class="ruby-comment"># read, yield, write</span>
  <span class="ruby-identifier">input</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">row</span>
    <span class="ruby-identifier">output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">row</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- filter-source -->
            
          </div>

          

          
        </div><!-- filter-method -->
      
        <div id="foreach-method" class="method-detail ">
          <a name="method-c-foreach"></a>

          
          <div class="method-heading">
            <span class="method-name">foreach</span><span
              class="method-args">(path, options = Hash.new, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>This method is intended as the primary interface for reading <a
href="CSV.html">CSV</a> files.  You pass a <code>path</code> and any
<code>options</code> you wish to set for the read.  Each row of file will
be passed to the provided <code>block</code> in turn.</p>

<p>The <code>options</code> parameter can be anything <a
href="CSV.html#method-c-new">::new</a> understands.  This method also
understands an additional <code>:encoding</code> parameter that you can use
to specify the Encoding of the data in the file to be read. You must
provide this unless your data is in Encoding::default_external().  <a
href="CSV.html">CSV</a> will use this to determine how to parse the data. 
You may provide a second Encoding to have the data transcoded as it is
read.  For example, <code>encoding: &quot;UTF-32BE:UTF-8&quot;</code> would
read UTF-32BE data from the file but transcode it to UTF-8 before <a
href="CSV.html">CSV</a> parses it.</p>
            

            
            <div class="method-source-code" id="foreach-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1205</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">foreach</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">csv</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- foreach-source -->
            
          </div>

          

          
        </div><!-- foreach-method -->
      
        <div id="generate-method" class="method-detail ">
          <a name="method-c-generate"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">generate( str, options = Hash.new ) { |csv| ... }</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">generate( options = Hash.new ) { |csv| ... }</span>
            
          </div>
          
          
          <div>
  
            
            <p>This method wraps a <a href="String.html">String</a> you provide, or an
empty default <a href="String.html">String</a>, in a <a
href="CSV.html">CSV</a> object which is passed to the provided block.  You
can use the block to append <a href="CSV.html">CSV</a> rows to the <a
href="String.html">String</a> and when the block exits, the final <a
href="String.html">String</a> will be returned.</p>

<p>Note that a passed <a href="String.html">String</a> <strong>is</strong>
modfied by this method.  Call dup() before passing if you need a new <a
href="String.html">String</a>.</p>

<p>The <code>options</code> parameter can be anything <a
href="CSV.html#method-c-new">::new</a> understands.  This method
understands an additional <code>:encoding</code> parameter when not passed
a <a href="String.html">String</a> to set the base Encoding for the output.
<a href="CSV.html">CSV</a> needs this hint if you plan to output non-ASCII
compatible data.</p>
            

            
            <div class="method-source-code" id="generate-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1229</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">generate</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-comment"># add a default empty String, if none was given</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
    <span class="ruby-identifier">io</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>)
    <span class="ruby-identifier">io</span>.<span class="ruby-identifier">seek</span>(<span class="ruby-value">0</span>, <span class="ruby-constant">IO</span><span class="ruby-operator">::</span><span class="ruby-constant">SEEK_END</span>)
    <span class="ruby-identifier">args</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-identifier">io</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">encoding</span> = (<span class="ruby-identifier">args</span>[<span class="ruby-value">-1</span>] = <span class="ruby-identifier">args</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">dup</span>).<span class="ruby-identifier">delete</span>(<span class="ruby-value">:encoding</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
    <span class="ruby-identifier">str</span>      = <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-identifier">str</span>.<span class="ruby-identifier">encode!</span>(<span class="ruby-identifier">encoding</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">encoding</span>
    <span class="ruby-identifier">args</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-identifier">str</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">csv</span> = <span class="ruby-identifier">new</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)  <span class="ruby-comment"># wrap</span>
  <span class="ruby-keyword">yield</span> <span class="ruby-identifier">csv</span>         <span class="ruby-comment"># yield for appending</span>
  <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">string</span>        <span class="ruby-comment"># return final String</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- generate-source -->
            
          </div>

          

          
        </div><!-- generate-method -->
      
        <div id="generate_line-method" class="method-detail ">
          <a name="method-c-generate_line"></a>

          
          <div class="method-heading">
            <span class="method-name">generate_line</span><span
              class="method-args">(row, options = Hash.new)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>This method is a shortcut for converting a single row (Array) into a <a
href="CSV.html">CSV</a> <a href="String.html">String</a>.</p>

<p>The <code>options</code> parameter can be anything <a
href="CSV.html#method-c-new">::new</a> understands.  This method
understands an additional <code>:encoding</code> parameter to set the base
Encoding for the output.  This method will try to guess your Encoding from
the first non-<code>nil</code> field in <code>row</code>, if possible, but
you may need to use this parameter as a backup plan.</p>

<p>The <code>:row_sep</code> <code>option</code> defaults to
<code>$INPUT_RECORD_SEPARATOR</code> (<code>$/</code>) when calling this
method.</p>
            

            
            <div class="method-source-code" id="generate_line-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1259</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">generate_line</span>(<span class="ruby-identifier">row</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
  <span class="ruby-identifier">options</span>  = {<span class="ruby-identifier">row_sep</span><span class="ruby-operator">:</span> <span class="ruby-identifier">$INPUT_RECORD_SEPARATOR</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">encoding</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:encoding</span>)
  <span class="ruby-identifier">str</span>      = <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">encoding</span>
    <span class="ruby-identifier">str</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-identifier">encoding</span>)
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">field</span> = <span class="ruby-identifier">row</span>.<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">nil?</span> }
    <span class="ruby-identifier">str</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-constant">String</span>(<span class="ruby-identifier">field</span>).<span class="ruby-identifier">encoding</span>)
  <span class="ruby-keyword">end</span>
  (<span class="ruby-identifier">new</span>(<span class="ruby-identifier">str</span>, <span class="ruby-identifier">options</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">row</span>).<span class="ruby-identifier">string</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- generate_line-source -->
            
          </div>

          

          
        </div><!-- generate_line-method -->
      
        <div id="instance-method" class="method-detail ">
          <a name="method-c-instance"></a>

          
          <div class="method-heading">
            <span class="method-name">instance</span><span
              class="method-args">(data = $stdout, options = Hash.new)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>This method will return a <a href="CSV.html">CSV</a> instance, just like <a
href="CSV.html#method-c-new">::new</a>, but the instance will be cached and
returned for all future calls to this method for the same <code>data</code>
object (tested by Object#object_id()) with the same <code>options</code>.</p>

<p>If a block is given, the instance is passed to the block and the return
value becomes the return value of the block.</p>
            

            
            <div class="method-source-code" id="instance-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 997</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">instance</span>(<span class="ruby-identifier">data</span> = <span class="ruby-identifier">$stdout</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
  <span class="ruby-comment"># create a _signature_ for this method call, data object and options</span>
  <span class="ruby-identifier">sig</span> = [<span class="ruby-identifier">data</span>.<span class="ruby-identifier">object_id</span>] <span class="ruby-operator">+</span>
        <span class="ruby-identifier">options</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-operator">*</span><span class="ruby-constant">DEFAULT_OPTIONS</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">sym</span><span class="ruby-operator">|</span> <span class="ruby-identifier">sym</span>.<span class="ruby-identifier">to_s</span> })

  <span class="ruby-comment"># fetch or create the instance for this signature</span>
  <span class="ruby-identifier">@@instances</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">instance</span>    =   (<span class="ruby-identifier">@@instances</span>[<span class="ruby-identifier">sig</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">new</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">options</span>))

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">instance</span>  <span class="ruby-comment"># run block, if given, returning result</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">instance</span>        <span class="ruby-comment"># or return the instance</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- instance-source -->
            
          </div>

          

          
        </div><!-- instance-method -->
      
        <div id="load-method" class="method-detail ">
          <a name="method-c-load"></a>

          
          <div class="method-heading">
            <span class="method-name">load</span><span
              class="method-args">(io_or_str, options = Hash.new)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>This method is the reading counterpart to <a
href="CSV.html#method-c-dump">::dump</a>.  See that method for a detailed
description of the process.</p>

<p>You can customize loading by adding a class method called csv_load() which
will be passed a Hash of meta information, an <a
href="Array.html">Array</a> of headers, and an <a
href="Array.html">Array</a> of fields for the object the method is expected
to return.</p>

<p>Remember that all fields will be Strings after this load.  If you need
something else, use <code>options</code> to setup converters or provide a
custom csv_load() implementation.</p>
            

            
            <div class="method-source-code" id="load-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1105</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">io_or_str</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
  <span class="ruby-identifier">csv</span> = <span class="ruby-identifier">new</span>(<span class="ruby-identifier">io_or_str</span>, <span class="ruby-identifier">options</span>)

  <span class="ruby-comment"># load meta information</span>
  <span class="ruby-identifier">meta</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-operator">*</span><span class="ruby-identifier">csv</span>.<span class="ruby-identifier">shift</span>]
  <span class="ruby-identifier">cls</span>  = <span class="ruby-identifier">meta</span>[<span class="ruby-string">&quot;class&quot;</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-identifier">csv</span>.<span class="ruby-identifier">encoding</span>)].<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;::&quot;</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-identifier">csv</span>.<span class="ruby-identifier">encoding</span>)).
                                            <span class="ruby-identifier">inject</span>(<span class="ruby-constant">Object</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span>, <span class="ruby-identifier">const</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">c</span>.<span class="ruby-identifier">const_get</span>(<span class="ruby-identifier">const</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># load headers</span>
  <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">shift</span>

  <span class="ruby-comment"># unserialize each object stored in the file</span>
  <span class="ruby-identifier">results</span> = <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">all</span>, <span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">cls</span>.<span class="ruby-identifier">csv_load</span>(<span class="ruby-identifier">meta</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-identifier">row</span>)
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>
      <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">cls</span>.<span class="ruby-identifier">allocate</span>
      <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">zip</span>(<span class="ruby-identifier">row</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value">?@</span>
          <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>)
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">all</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">io_or_str</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>

  <span class="ruby-identifier">results</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- load-source -->
            
          </div>

          

          
        </div><!-- load-method -->
      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">(data, options = Hash.new)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>This constructor will wrap either a <a href="String.html">String</a> or IO
object passed in <code>data</code> for reading and/or writing.  In addition
to the <a href="CSV.html">CSV</a> instance methods, several IO methods are
delegated.  (See <a href="CSV.html#method-c-open">::open</a> for a complete
list.)  If you pass a <a href="String.html">String</a> for
<code>data</code>, you can later retrieve it (after writing to it, for
example) with CSV.string().</p>

<p>Note that a wrapped <a href="String.html">String</a> will be positioned at
at the beginning (for reading).  If you want it at the end (for writing),
use <a href="CSV.html#method-c-generate">::generate</a>. If you want any
other positioning, pass a preset StringIO object instead.</p>

<p>You may set any reading and/or writing preferences in the
<code>options</code> Hash. Available options are:</p>
<dl class="rdoc-list note-list"><dt><strong><code>:col_sep</code></strong>
<dd>
<p>The <a href="String.html">String</a> placed between each field. This <a
href="String.html">String</a> will be transcoded into the data’s Encoding
before parsing.</p>
</dd><dt><strong><code>:row_sep</code></strong>
<dd>
<p>The <a href="String.html">String</a> appended to the end of each row.  This
can be set to the special <code>:auto</code> setting, which requests that
<a href="CSV.html">CSV</a> automatically discover this from the data. 
Auto-discovery reads ahead in the data looking for the next
<code>&quot;\r\n&quot;</code>, <code>&quot;\n&quot;</code>, or
<code>&quot;\r&quot;</code> sequence.  A sequence will be selected even if
it occurs in a quoted field, assuming that you would have the same line
endings there.  If none of those sequences is found, <code>data</code> is
<code>ARGF</code>, <code>STDIN</code>, <code>STDOUT</code>, or
<code>STDERR</code>, or the stream is only available for output, the
default <code>$INPUT_RECORD_SEPARATOR</code> (<code>$/</code>) is used. 
Obviously, discovery takes a little time.  Set manually if speed is
important.  Also note that IO objects should be opened in binary mode on
Windows if this feature will be used as the line-ending translation can
cause problems with resetting the document position to where it was before
the read ahead. This <a href="String.html">String</a> will be transcoded
into the data’s Encoding before parsing.</p>
</dd><dt><strong><code>:quote_char</code></strong>
<dd>
<p>The character used to quote fields. This has to be a single character <a
href="String.html">String</a>.  This is useful for application that
incorrectly use <code>'</code> as the quote character instead of the
correct <code>&quot;</code>. <a href="CSV.html">CSV</a> will always
consider a double sequence this character to be an escaped quote. This <a
href="String.html">String</a> will be transcoded into the data’s Encoding
before parsing.</p>
</dd><dt><strong><code>:field_size_limit</code></strong>
<dd>
<p>This is a maximum size <a href="CSV.html">CSV</a> will read ahead looking
for the closing quote for a field.  (In truth, it reads to the first line
ending beyond this size.)  If a quote cannot be found within the limit <a
href="CSV.html">CSV</a> will raise a <a
href="CSV/MalformedCSVError.html">MalformedCSVError</a>, assuming the data
is faulty.  You can use this limit to prevent what are effectively DoS
attacks on the parser.  However, this limit can cause a legitimate parse to
fail and thus is set to <code>nil</code>, or off, by default.</p>
</dd><dt><strong><code>:converters</code></strong>
<dd>
<p>An <a href="Array.html">Array</a> of names from the <a
href="CSV.html#Converters">Converters</a> Hash and/or lambdas that handle
custom conversion.  A single converter doesn’t have to be in an <a
href="Array.html">Array</a>.  All built-in converters try to transcode
fields to UTF-8 before converting. The conversion will fail if the data
cannot be transcoded, leaving the field unchanged.</p>
</dd><dt><strong><code>:unconverted_fields</code></strong>
<dd>
<p>If set to <code>true</code>, an unconverted_fields() method will be added
to all returned rows (Array or <a href="CSV/Row.html">CSV::Row</a>) that
will return the fields as they were before conversion.  Note that
<code>:headers</code> supplied by <a href="Array.html">Array</a> or <a
href="String.html">String</a> were not fields of the document and thus will
have an empty <a href="Array.html">Array</a> attached.</p>
</dd><dt><strong><code>:headers</code></strong>
<dd>
<p>If set to <code>:first_row</code> or <code>true</code>, the initial row of
the <a href="CSV.html">CSV</a> file will be treated as a row of headers. 
If set to an <a href="Array.html">Array</a>, the contents will be used as
the headers. If set to a <a href="String.html">String</a>, the <a
href="String.html">String</a> is run through a call of <a
href="CSV.html#method-c-parse_line">::parse_line</a> with the same
<code>:col_sep</code>, <code>:row_sep</code>, and <code>:quote_char</code>
as this instance to produce an <a href="Array.html">Array</a> of headers. 
This setting causes <a href="CSV.html#method-i-shift">#shift</a> to return
rows as <a href="CSV/Row.html">CSV::Row</a> objects instead of Arrays and
<a href="CSV.html#method-i-read">#read</a> to return <a
href="CSV/Table.html">CSV::Table</a> objects instead of an <a
href="Array.html">Array</a> of Arrays.</p>
</dd><dt><strong><code>:return_headers</code></strong>
<dd>
<p>When <code>false</code>, header rows are silently swallowed.  If set to
<code>true</code>, header rows are returned in a <a
href="CSV/Row.html">CSV::Row</a> object with identical headers and fields
(save that the fields do not go through the converters).</p>
</dd><dt><strong><code>:write_headers</code></strong>
<dd>
<p>When <code>true</code> and <code>:headers</code> is set, a header row will
be added to the output.</p>
</dd><dt><strong><code>:header_converters</code></strong>
<dd>
<p>Identical in functionality to <code>:converters</code> save that the
conversions are only made to header rows.  All built-in converters try to
transcode headers to UTF-8 before converting.  The conversion will fail if
the data cannot be transcoded, leaving the header unchanged.</p>
</dd><dt><strong><code>:skip_blanks</code></strong>
<dd>
<p>When set to a <code>true</code> value, <a href="CSV.html">CSV</a> will skip
over any rows with no content.</p>
</dd><dt><strong><code>:force_quotes</code></strong>
<dd>
<p>When set to a <code>true</code> value, <a href="CSV.html">CSV</a> will
quote all <a href="CSV.html">CSV</a> fields it creates.</p>
</dd></dl>

<p>See CSV::DEFAULT_OPTIONS for the default settings.</p>

<p>Options cannot be overridden in the instance methods for performance
reasons, so be sure to set what you want here.</p>
            

            
            <div class="method-source-code" id="new-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1562</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
  <span class="ruby-comment"># build the options for this read/write</span>
  <span class="ruby-identifier">options</span> = <span class="ruby-constant">DEFAULT_OPTIONS</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>)

  <span class="ruby-comment"># create the IO object we will read from</span>
  <span class="ruby-ivar">@io</span>       = <span class="ruby-identifier">data</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>) <span class="ruby-operator">?</span> <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">data</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">data</span>
  <span class="ruby-comment"># honor the IO encoding if we can, otherwise default to ASCII-8BIT</span>
  <span class="ruby-ivar">@encoding</span> = <span class="ruby-identifier">raw_encoding</span>(<span class="ruby-keyword">nil</span>) <span class="ruby-operator">||</span>
              ( <span class="ruby-keyword">if</span> <span class="ruby-identifier">encoding</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:internal_encoding</span>)
                  <span class="ruby-keyword">case</span> <span class="ruby-identifier">encoding</span>
                  <span class="ruby-keyword">when</span> <span class="ruby-constant">Encoding</span>; <span class="ruby-identifier">encoding</span>
                  <span class="ruby-keyword">else</span> <span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">encoding</span>)
                  <span class="ruby-keyword">end</span>
                <span class="ruby-keyword">end</span> ) <span class="ruby-operator">||</span>
              ( <span class="ruby-keyword">case</span> <span class="ruby-identifier">encoding</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:encoding</span>)
                <span class="ruby-keyword">when</span> <span class="ruby-constant">Encoding</span>; <span class="ruby-identifier">encoding</span>
                <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\A[^:]+/</span>; <span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">find</span>(<span class="ruby-node">$&amp;</span>)
                <span class="ruby-keyword">end</span> ) <span class="ruby-operator">||</span>
              <span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">default_internal</span> <span class="ruby-operator">||</span> <span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">default_external</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-comment"># prepare for building safe regular expressions in the target encoding,</span>
  <span class="ruby-comment"># if we can transcode the needed characters</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-ivar">@re_esc</span>   =   <span class="ruby-string">&quot;\\&quot;</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-ivar">@encoding</span>) <span class="ruby-keyword">rescue</span> <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-ivar">@re_chars</span> =   <span class="ruby-node">/#{%&quot;[-][\\.^$?*+{}()|# \r\n\t\f\v]&quot;.encode(@encoding)}/</span>
  <span class="ruby-comment"># @re_chars =   /#{%&quot;[-][\\.^$?*+{}()|# \r\n\t\f\v]&quot;.encode(@encoding, fallback: proc{&quot;&quot;})}/</span>

  <span class="ruby-identifier">init_separators</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">init_parsers</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">init_converters</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">init_headers</span>(<span class="ruby-identifier">options</span>)

  <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:encoding</span>)
  <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:internal_encoding</span>)
  <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:external_encoding</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;Unknown options:  #{options.keys.join(', ')}.&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># track our own lineno since IO gets confused about line-ends is CSV fields</span>
  <span class="ruby-ivar">@lineno</span> = <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->
      
        <div id="open-method" class="method-detail ">
          <a name="method-c-open"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">open( filename, mode = "rb", options = Hash.new ) { |faster_csv| ... }</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">open( filename, options = Hash.new ) { |faster_csv| ... }</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">open( filename, mode = "rb", options = Hash.new )</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">open( filename, options = Hash.new )</span>
            
          </div>
          
          
          <div>
  
            
            <p>This method opens an IO object, and wraps that with <a
href="CSV.html">CSV</a>.  This is intended as the primary interface for
writing a <a href="CSV.html">CSV</a> file.</p>

<p>You must pass a <code>filename</code> and may optionally add a
<code>mode</code> for Ruby’s open().  You may also pass an optional Hash
containing any <code>options</code> <a
href="CSV.html#method-c-new">::new</a> understands as the final argument.</p>

<p>This method works like Ruby’s open() call, in that it will pass a <a
href="CSV.html">CSV</a> object to a provided block and close it when the
block terminates, or it will return the <a href="CSV.html">CSV</a> object
when no block is provided.  (<strong>Note</strong>: This is different from
the Ruby 1.8 <a href="CSV.html">CSV</a> library which passed rows to the
block.  Use <a href="CSV.html#method-c-foreach">::foreach</a> for that
behavior.)</p>

<p>You must provide a <code>mode</code> with an embedded Encoding designator
unless your data is in Encoding::default_external().  <a
href="CSV.html">CSV</a> will check the Encoding of the underlying IO object
(set by the <code>mode</code> you pass) to determine how to parse the data.
You may provide a second Encoding to have the data transcoded as it is read
just as you can with a normal call to IO::open().  For example,
<code>&quot;rb:UTF-32BE:UTF-8&quot;</code> would read UTF-32BE data from
the file but transcode it to UTF-8 before <a href="CSV.html">CSV</a> parses
it.</p>

<p>An opened <a href="CSV.html">CSV</a> object will delegate to many IO
methods for convenience.  You may call:</p>
<ul><li>
<p>binmode()</p>
</li><li>
<p>binmode?()</p>
</li><li>
<p>close()</p>
</li><li>
<p>close_read()</p>
</li><li>
<p>close_write()</p>
</li><li>
<p>closed?()</p>
</li><li>
<p>eof()</p>
</li><li>
<p>eof?()</p>
</li><li>
<p>external_encoding()</p>
</li><li>
<p>fcntl()</p>
</li><li>
<p>fileno()</p>
</li><li>
<p>flock()</p>
</li><li>
<p>flush()</p>
</li><li>
<p>fsync()</p>
</li><li>
<p>internal_encoding()</p>
</li><li>
<p>ioctl()</p>
</li><li>
<p>isatty()</p>
</li><li>
<p>path()</p>
</li><li>
<p>pid()</p>
</li><li>
<p>pos()</p>
</li><li>
<p>pos=()</p>
</li><li>
<p>reopen()</p>
</li><li>
<p>seek()</p>
</li><li>
<p>stat()</p>
</li><li>
<p>sync()</p>
</li><li>
<p>sync=()</p>
</li><li>
<p>tell()</p>
</li><li>
<p>to_i()</p>
</li><li>
<p>to_io()</p>
</li><li>
<p>truncate()</p>
</li><li>
<p>tty?()</p>
</li></ul>
            

            
            <div class="method-source-code" id="open-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1334</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">open</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-comment"># find the +options+ Hash</span>
  <span class="ruby-identifier">options</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Hash</span> <span class="ruby-keyword">then</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span> <span class="ruby-keyword">else</span> <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># wrap a File opened with the remaining +args+ with no newline</span>
  <span class="ruby-comment"># decorator</span>
  <span class="ruby-identifier">file_opts</span> = {<span class="ruby-identifier">universal_newline</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-identifier">file_opts</span>)
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">ArgumentError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-keyword">unless</span> <span class="ruby-regexp">/needs binmode/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">message</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">args</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;rb&quot;</span>
    <span class="ruby-identifier">file_opts</span> = {<span class="ruby-identifier">encoding</span><span class="ruby-operator">:</span> <span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">default_external</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">file_opts</span>)
    <span class="ruby-keyword">retry</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">csv</span> = <span class="ruby-identifier">new</span>(<span class="ruby-identifier">f</span>, <span class="ruby-identifier">options</span>)

  <span class="ruby-comment"># handle blocks like Ruby's open(), not like the CSV library</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-keyword">yield</span> <span class="ruby-identifier">csv</span>
    <span class="ruby-keyword">ensure</span>
      <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">close</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">csv</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- open-source -->
            
          </div>

          

          
        </div><!-- open-method -->
      
        <div id="parse-method" class="method-detail ">
          <a name="method-c-parse"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">parse( str, options = Hash.new ) { |row| ... }</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">parse( str, options = Hash.new )</span>
            
          </div>
          
          
          <div>
  
            
            <p>This method can be used to easily parse <a href="CSV.html">CSV</a> out of a
<a href="String.html">String</a>.  You may either provide a
<code>block</code> which will be called with each row of the <a
href="String.html">String</a> in turn, or just use the returned <a
href="Array.html">Array</a> of Arrays (when no <code>block</code> is
given).</p>

<p>You pass your <code>str</code> to read from, and an optional
<code>options</code> Hash containing anything <a
href="CSV.html#method-c-new">::new</a> understands.</p>
            

            
            <div class="method-source-code" id="parse-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1374</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">csv</span> = <span class="ruby-identifier">new</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">nil?</span>  <span class="ruby-comment"># slurp contents, if no block is given</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">read</span>
    <span class="ruby-keyword">ensure</span>
      <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">close</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>           <span class="ruby-comment"># or pass each row to a provided block</span>
    <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- parse-source -->
            
          </div>

          

          
        </div><!-- parse-method -->
      
        <div id="parse_line-method" class="method-detail ">
          <a name="method-c-parse_line"></a>

          
          <div class="method-heading">
            <span class="method-name">parse_line</span><span
              class="method-args">(line, options = Hash.new)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>This method is a shortcut for converting a single line of a <a
href="CSV.html">CSV</a> <a href="String.html">String</a> into a into an <a
href="Array.html">Array</a>.  Note that if <code>line</code> contains
multiple rows, anything beyond the first row is ignored.</p>

<p>The <code>options</code> parameter can be anything <a
href="CSV.html#method-c-new">::new</a> understands.</p>
            

            
            <div class="method-source-code" id="parse_line-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1394</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parse_line</span>(<span class="ruby-identifier">line</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
  <span class="ruby-identifier">new</span>(<span class="ruby-identifier">line</span>, <span class="ruby-identifier">options</span>).<span class="ruby-identifier">shift</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- parse_line-source -->
            
          </div>

          

          
        </div><!-- parse_line-method -->
      
        <div id="read-method" class="method-detail ">
          <a name="method-c-read"></a>

          
          <div class="method-heading">
            <span class="method-name">read</span><span
              class="method-args">(path, *options)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Use to slurp a <a href="CSV.html">CSV</a> file into an <a
href="Array.html">Array</a> of Arrays.  Pass the <code>path</code> to the
file and any <code>options</code> <a href="CSV.html#method-c-new">::new</a>
understands.  This method also understands an additional
<code>:encoding</code> parameter that you can use to specify the Encoding
of the data in the file to be read. You must provide this unless your data
is in Encoding::default_external().  <a href="CSV.html">CSV</a> will use
this to determine how to parse the data.  You may provide a second Encoding
to have the data transcoded as it is read.  For example, <code>encoding:
&quot;UTF-32BE:UTF-8&quot;</code> would read UTF-32BE data from the file
but transcode it to UTF-8 before <a href="CSV.html">CSV</a> parses it.</p>
            

            
            <div class="method-source-code" id="read-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1409</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">path</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">options</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">csv</span><span class="ruby-operator">|</span> <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">read</span> }
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- read-source -->
            
          </div>

          

          
        </div><!-- read-method -->
      
        <div id="readlines-method" class="method-detail ">
          <a name="method-c-readlines"></a>

          
          <div class="method-heading">
            <span class="method-name">readlines</span><span
              class="method-args">(*args)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Alias for <a href="CSV.html#method-c-read">::read</a>.</p>
            

            
            <div class="method-source-code" id="readlines-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1414</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">readlines</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
  <span class="ruby-identifier">read</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- readlines-source -->
            
          </div>

          

          
        </div><!-- readlines-method -->
      
        <div id="table-method" class="method-detail ">
          <a name="method-c-table"></a>

          
          <div class="method-heading">
            <span class="method-name">table</span><span
              class="method-args">(path, options = Hash.new)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>A shortcut for:</p>

<pre>CSV.read( path, { headers:           true,
                  converters:        :numeric,
                  header_converters: :symbol }.merge(options) )</pre>
            

            
            <div class="method-source-code" id="table-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1425</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">table</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
  <span class="ruby-identifier">read</span>( <span class="ruby-identifier">path</span>, { <span class="ruby-identifier">headers</span><span class="ruby-operator">:</span>           <span class="ruby-keyword">true</span>,
                <span class="ruby-identifier">converters</span><span class="ruby-operator">:</span>        <span class="ruby-value">:numeric</span>,
                <span class="ruby-identifier">header_converters</span><span class="ruby-operator">:</span> <span class="ruby-value">:symbol</span> }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>) )
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- table-source -->
            
          </div>

          

          
        </div><!-- table-method -->
      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="3C-3C-method" class="method-detail ">
          <a name="method-i-3C-3C"></a>

          
          <div class="method-heading">
            <span class="method-name">&lt;&lt;</span><span
              class="method-args">(row)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>The primary write method for wrapped Strings and IOs, <code>row</code> (an
<a href="Array.html">Array</a> or <a href="CSV/Row.html">CSV::Row</a>) is
converted to <a href="CSV.html">CSV</a> and appended to the data source. 
When a <a href="CSV/Row.html">CSV::Row</a> is passed, only the row’s
fields() are appended to the output.</p>

<p>The data source must be open for writing.</p>
            

            
            <div class="method-source-code" id="3C-3C-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1711</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">&lt;&lt;</span>(<span class="ruby-identifier">row</span>)
  <span class="ruby-comment"># make sure headers have been assigned</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">header_row?</span> <span class="ruby-keyword">and</span> [<span class="ruby-constant">Array</span>, <span class="ruby-constant">String</span>].<span class="ruby-identifier">include?</span> <span class="ruby-ivar">@use_headers</span>.<span class="ruby-identifier">class</span>
    <span class="ruby-identifier">parse_headers</span>  <span class="ruby-comment"># won't read data for Array or String</span>
    <span class="ruby-keyword">self</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@headers</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@write_headers</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># handle CSV::Row objects and Hashes</span>
  <span class="ruby-identifier">row</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">row</span>
        <span class="ruby-keyword">when</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span><span class="ruby-operator">::</span><span class="ruby-constant">Row</span> <span class="ruby-keyword">then</span> <span class="ruby-identifier">row</span>.<span class="ruby-identifier">fields</span>
        <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>            <span class="ruby-keyword">then</span> <span class="ruby-ivar">@headers</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">header</span><span class="ruby-operator">|</span> <span class="ruby-identifier">row</span>[<span class="ruby-identifier">header</span>] }
        <span class="ruby-keyword">else</span>                      <span class="ruby-identifier">row</span>
        <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@headers</span> =  <span class="ruby-identifier">row</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">header_row?</span>
  <span class="ruby-ivar">@lineno</span>  <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>

  <span class="ruby-identifier">output</span> = <span class="ruby-identifier">row</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-ivar">@quote</span>).<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@col_sep</span>) <span class="ruby-operator">+</span> <span class="ruby-ivar">@row_sep</span>  <span class="ruby-comment"># quote and separate</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">StringIO</span>)             <span class="ruby-keyword">and</span>
     <span class="ruby-identifier">output</span>.<span class="ruby-identifier">encoding</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">raw_encoding</span> <span class="ruby-keyword">and</span>
     (<span class="ruby-identifier">compatible_encoding</span> = <span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">compatible?</span>(<span class="ruby-ivar">@io</span>.<span class="ruby-identifier">string</span>, <span class="ruby-identifier">output</span>))
    <span class="ruby-ivar">@io</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@io</span>.<span class="ruby-identifier">string</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-identifier">compatible_encoding</span>))
    <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">seek</span>(<span class="ruby-value">0</span>, <span class="ruby-constant">IO</span><span class="ruby-operator">::</span><span class="ruby-constant">SEEK_END</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@io</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">output</span>

  <span class="ruby-keyword">self</span>  <span class="ruby-comment"># for chaining</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- 3C-3C-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="CSV.html#method-i-add_row">add_row</a>, <a href="CSV.html#method-i-puts">puts</a>
          </div>
          

          
        </div><!-- 3C-3C-method -->
      
        <div id="add_row-method" class="method-detail method-alias">
          <a name="method-i-add_row"></a>

          
          <div class="method-heading">
            <span class="method-name">add_row</span><span
              class="method-args">(row)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="CSV.html#method-i-3C-3C">&lt;&lt;</a>
          </div>
          
        </div><!-- add_row-method -->
      
        <div id="convert-method" class="method-detail ">
          <a name="method-i-convert"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">convert( name )</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">convert { |field| ... }</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">convert { |field, field_info| ... }</span>
            
          </div>
          
          
          <div>
  
            
            <p>You can use this method to install a CSV::Converters built-in, or provide a
block that handles a custom conversion.</p>

<p>If you provide a block that takes one argument, it will be passed the field
and is expected to return the converted value or the field itself.  If your
block takes two arguments, it will also be passed a CSV::FieldInfo Struct,
containing details about the field.  Again, the block should return a
converted field or the field itself.</p>
            

            
            <div class="method-source-code" id="convert-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1757</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">convert</span>(<span class="ruby-identifier">name</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">converter</span>)
  <span class="ruby-identifier">add_converter</span>(<span class="ruby-value">:converters</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span><span class="ruby-operator">::</span><span class="ruby-constant">Converters</span>, <span class="ruby-identifier">name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">converter</span>)
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- convert-source -->
            
          </div>

          

          
        </div><!-- convert-method -->
      
        <div id="converters-method" class="method-detail ">
          <a name="method-i-converters"></a>

          
          <div class="method-heading">
            <span class="method-name">converters</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Returns the current list of converters in effect.  See <a
href="CSV.html#method-c-new">::new</a> for details. Built-in converters
will be returned by name, while others will be returned as is.</p>
            

            
            <div class="method-source-code" id="converters-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1627</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">converters</span>
  <span class="ruby-ivar">@converters</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">converter</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">name</span> = <span class="ruby-constant">Converters</span>.<span class="ruby-identifier">rassoc</span>(<span class="ruby-identifier">converter</span>)
    <span class="ruby-identifier">name</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">converter</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- converters-source -->
            
          </div>

          

          
        </div><!-- converters-method -->
      
        <div id="each-method" class="method-detail ">
          <a name="method-i-each"></a>

          
          <div class="method-heading">
            <span class="method-name">each</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Yields each row of the data source in turn.</p>

<p>Support for Enumerable.</p>

<p>The data source must be open for reading.</p>
            

            
            <div class="method-source-code" id="each-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1788</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-keyword">while</span> <span class="ruby-identifier">row</span> = <span class="ruby-identifier">shift</span>
      <span class="ruby-keyword">yield</span> <span class="ruby-identifier">row</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">to_enum</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- each-source -->
            
          </div>

          

          
        </div><!-- each-method -->
      
        <div id="force_quotes-3F-method" class="method-detail ">
          <a name="method-i-force_quotes-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">force_quotes?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Returns <code>true</code> if all output fields are quoted. See <a
href="CSV.html#method-c-new">::new</a> for details.</p>
            

            
            <div class="method-source-code" id="force_quotes-3F-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1670</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">force_quotes?</span>()       <span class="ruby-ivar">@force_quotes</span>       <span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- force_quotes-3F-source -->
            
          </div>

          

          
        </div><!-- force_quotes-3F-method -->
      
        <div id="gets-method" class="method-detail method-alias">
          <a name="method-i-gets"></a>

          
          <div class="method-heading">
            <span class="method-name">gets</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="CSV.html#method-i-shift">shift</a>
          </div>
          
        </div><!-- gets-method -->
      
        <div id="header_convert-method" class="method-detail ">
          <a name="method-i-header_convert"></a>

          
          
          <div class="method-heading">
            <span class="method-callseq">header_convert( name )</span>
            
            <span class="method-click-advice">click to toggle source</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">header_convert { |field| ... }</span>
            
          </div>
          
          <div class="method-heading">
            <span class="method-callseq">header_convert { |field, field_info| ... }</span>
            
          </div>
          
          
          <div>
  
            
            <p>Identical to <a href="CSV.html#method-i-convert">#convert</a>, but for
header rows.</p>

<p>Note that this method must be called before header rows are read to have
any effect.</p>
            

            
            <div class="method-source-code" id="header_convert-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1772</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">header_convert</span>(<span class="ruby-identifier">name</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">converter</span>)
  <span class="ruby-identifier">add_converter</span>( <span class="ruby-value">:header_converters</span>,
                 <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span><span class="ruby-operator">::</span><span class="ruby-constant">HeaderConverters</span>,
                 <span class="ruby-identifier">name</span>,
                 <span class="ruby-operator">&amp;</span><span class="ruby-identifier">converter</span> )
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- header_convert-source -->
            
          </div>

          

          
        </div><!-- header_convert-method -->
      
        <div id="header_converters-method" class="method-detail ">
          <a name="method-i-header_converters"></a>

          
          <div class="method-heading">
            <span class="method-name">header_converters</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Returns the current list of converters in effect for headers.  See <a
href="CSV.html#method-c-new">::new</a> for details.  Built-in converters
will be returned by name, while others will be returned as is.</p>
            

            
            <div class="method-source-code" id="header_converters-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1658</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">header_converters</span>
  <span class="ruby-ivar">@header_converters</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">converter</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">name</span> = <span class="ruby-constant">HeaderConverters</span>.<span class="ruby-identifier">rassoc</span>(<span class="ruby-identifier">converter</span>)
    <span class="ruby-identifier">name</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">converter</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- header_converters-source -->
            
          </div>

          

          
        </div><!-- header_converters-method -->
      
        <div id="header_row-3F-method" class="method-detail ">
          <a name="method-i-header_row-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">header_row?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Returns <code>true</code> if the next row read will be a header row.</p>
            

            
            <div class="method-source-code" id="header_row-3F-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1814</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">header_row?</span>
  <span class="ruby-ivar">@use_headers</span> <span class="ruby-keyword">and</span> <span class="ruby-ivar">@headers</span>.<span class="ruby-identifier">nil?</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- header_row-3F-source -->
            
          </div>

          

          
        </div><!-- header_row-3F-method -->
      
        <div id="headers-method" class="method-detail ">
          <a name="method-i-headers"></a>

          
          <div class="method-heading">
            <span class="method-name">headers</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Returns <code>nil</code> if headers will not be used, <code>true</code> if
they will but have not yet been read, or the actual headers after they have
been read.  See <a href="CSV.html#method-c-new">::new</a> for details.</p>
            

            
            <div class="method-source-code" id="headers-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1643</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">headers</span>
  <span class="ruby-ivar">@headers</span> <span class="ruby-operator">||</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@use_headers</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- headers-source -->
            
          </div>

          

          
        </div><!-- headers-method -->
      
        <div id="inspect-method" class="method-detail ">
          <a name="method-i-inspect"></a>

          
          <div class="method-heading">
            <span class="method-name">inspect</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Returns a simplified description of the key <a href="CSV.html">CSV</a>
attributes in an ASCII compatible <a href="String.html">String</a>.</p>
            

            
            <div class="method-source-code" id="inspect-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1973</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inspect</span>
  <span class="ruby-identifier">str</span> = [<span class="ruby-node">&quot;&lt;#&quot;</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-string">&quot; io_type:&quot;</span>]
  <span class="ruby-comment"># show type of wrapped IO</span>
  <span class="ruby-keyword">if</span>    <span class="ruby-ivar">@io</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">$stdout</span> <span class="ruby-keyword">then</span> <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;$stdout&quot;</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@io</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">$stdin</span>  <span class="ruby-keyword">then</span> <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;$stdin&quot;</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@io</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">$stderr</span> <span class="ruby-keyword">then</span> <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;$stderr&quot;</span>
  <span class="ruby-keyword">else</span>                      <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># show IO.path(), if available</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:path</span>) <span class="ruby-keyword">and</span> (<span class="ruby-identifier">p</span> = <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">path</span>)
    <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; io_path:&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">inspect</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># show encoding</span>
  <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; encoding:&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@encoding</span>.<span class="ruby-identifier">name</span>
  <span class="ruby-comment"># show other attributes</span>
  <span class="ruby-node">%w[ lineno     col_sep     row_sep
      quote_char skip_blanks ]</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attr_name</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span> = <span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-node">&quot;@#{attr_name}&quot;</span>)
      <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; &quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">attr_name</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;:&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">inspect</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@use_headers</span>
    <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; headers:&quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">inspect</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&gt;&quot;</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">str</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">''</span>)
  <span class="ruby-keyword">rescue</span>  <span class="ruby-comment"># any encoding error</span>
    <span class="ruby-identifier">str</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">e</span> = <span class="ruby-constant">Encoding</span><span class="ruby-operator">::</span><span class="ruby-constant">Converter</span>.<span class="ruby-identifier">asciicompat_encoding</span>(<span class="ruby-identifier">s</span>.<span class="ruby-identifier">encoding</span>)
      <span class="ruby-identifier">e</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-identifier">e</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-string">&quot;ASCII-8BIT&quot;</span>)
    <span class="ruby-keyword">end</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">''</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- inspect-source -->
            
          </div>

          

          
        </div><!-- inspect-method -->
      
        <div id="puts-method" class="method-detail method-alias">
          <a name="method-i-puts"></a>

          
          <div class="method-heading">
            <span class="method-name">puts</span><span
              class="method-args">(row)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="CSV.html#method-i-3C-3C">&lt;&lt;</a>
          </div>
          
        </div><!-- puts-method -->
      
        <div id="read-method" class="method-detail ">
          <a name="method-i-read"></a>

          
          <div class="method-heading">
            <span class="method-name">read</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Slurps the remaining rows and returns an <a href="Array.html">Array</a> of
Arrays.</p>

<p>The data source must be open for reading.</p>
            

            
            <div class="method-source-code" id="read-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1803</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">read</span>
  <span class="ruby-identifier">rows</span> = <span class="ruby-identifier">to_a</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@use_headers</span>
    <span class="ruby-constant">Table</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">rows</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rows</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- read-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="CSV.html#method-i-readlines">readlines</a>
          </div>
          

          
        </div><!-- read-method -->
      
        <div id="readline-method" class="method-detail method-alias">
          <a name="method-i-readline"></a>

          
          <div class="method-heading">
            <span class="method-name">readline</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="CSV.html#method-i-shift">shift</a>
          </div>
          
        </div><!-- readline-method -->
      
        <div id="readlines-method" class="method-detail method-alias">
          <a name="method-i-readlines"></a>

          
          <div class="method-heading">
            <span class="method-name">readlines</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="CSV.html#method-i-read">read</a>
          </div>
          
        </div><!-- readlines-method -->
      
        <div id="return_headers-3F-method" class="method-detail ">
          <a name="method-i-return_headers-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">return_headers?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Returns <code>true</code> if headers will be returned as a row of results.
See <a href="CSV.html#method-c-new">::new</a> for details.</p>
            

            
            <div class="method-source-code" id="return_headers-3F-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1650</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">return_headers?</span>()     <span class="ruby-ivar">@return_headers</span>     <span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- return_headers-3F-source -->
            
          </div>

          

          
        </div><!-- return_headers-3F-method -->
      
        <div id="rewind-method" class="method-detail ">
          <a name="method-i-rewind"></a>

          
          <div class="method-heading">
            <span class="method-name">rewind</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Rewinds the underlying IO object and resets CSV’s lineno() counter.</p>
            

            
            <div class="method-source-code" id="rewind-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1695</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rewind</span>
  <span class="ruby-ivar">@headers</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@lineno</span>  = <span class="ruby-value">0</span>

  <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">rewind</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- rewind-source -->
            
          </div>

          

          
        </div><!-- rewind-method -->
      
        <div id="shift-method" class="method-detail ">
          <a name="method-i-shift"></a>

          
          <div class="method-heading">
            <span class="method-name">shift</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>The primary read method for wrapped Strings and IOs, a single row is pulled
from the data source, parsed and returned as an <a
href="Array.html">Array</a> of fields (if header rows are not used) or a <a
href="CSV/Row.html">CSV::Row</a> (when header rows are used).</p>

<p>The data source must be open for reading.</p>
            

            
            <div class="method-source-code" id="shift-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1825</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">shift</span>
  <span class="ruby-comment">#########################################################################</span>
  <span class="ruby-comment">### This method is purposefully kept a bit long as simple conditional ###</span>
  <span class="ruby-comment">### checks are faster than numerous (expensive) method calls.         ###</span>
  <span class="ruby-comment">#########################################################################</span>

  <span class="ruby-comment"># handle headers not based on document content</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">header_row?</span> <span class="ruby-keyword">and</span> <span class="ruby-ivar">@return_headers</span> <span class="ruby-keyword">and</span>
     [<span class="ruby-constant">Array</span>, <span class="ruby-constant">String</span>].<span class="ruby-identifier">include?</span> <span class="ruby-ivar">@use_headers</span>.<span class="ruby-identifier">class</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@unconverted_fields</span>
      <span class="ruby-keyword">return</span> <span class="ruby-identifier">add_unconverted_fields</span>(<span class="ruby-identifier">parse_headers</span>, <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">return</span> <span class="ruby-identifier">parse_headers</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment">#</span>
  <span class="ruby-comment"># it can take multiple calls to &lt;tt&gt;@io.gets()&lt;/tt&gt; to get a full line,</span>
  <span class="ruby-comment"># because of \r and/or \n characters embedded in quoted fields</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-identifier">in_extended_col</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">csv</span>             = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-identifier">loop</span> <span class="ruby-keyword">do</span>
    <span class="ruby-comment"># add another read to the line</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">parse</span> = <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">gets</span>(<span class="ruby-ivar">@row_sep</span>)
      <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">parse</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-ivar">@parsers</span>[<span class="ruby-value">:line_end</span>], <span class="ruby-string">&quot;&quot;</span>)

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-comment">#</span>
      <span class="ruby-comment"># I believe a blank line should be an &lt;tt&gt;Array.new&lt;/tt&gt;, not Ruby 1.8</span>
      <span class="ruby-comment"># CSV's &lt;tt&gt;[nil]&lt;/tt&gt;</span>
      <span class="ruby-comment">#</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">parse</span>.<span class="ruby-identifier">empty?</span>
        <span class="ruby-ivar">@lineno</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword">if</span> <span class="ruby-ivar">@skip_blanks</span>
          <span class="ruby-keyword">next</span>
        <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@unconverted_fields</span>
          <span class="ruby-keyword">return</span> <span class="ruby-identifier">add_unconverted_fields</span>(<span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>, <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>)
        <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@use_headers</span>
          <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span><span class="ruby-operator">::</span><span class="ruby-constant">Row</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>, <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-keyword">return</span> <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">parts</span> =  <span class="ruby-identifier">parse</span>.<span class="ruby-identifier">split</span>(<span class="ruby-ivar">@col_sep</span>, <span class="ruby-value">-1</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">parts</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">in_extended_col</span>
        <span class="ruby-identifier">csv</span>[<span class="ruby-value">-1</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@col_sep</span>   <span class="ruby-comment"># will be replaced with a @row_sep after the parts.each loop</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword">nil</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># This loop is the hot path of csv parsing. Some things may be non-dry</span>
    <span class="ruby-comment"># for a reason. Make sure to benchmark when refactoring.</span>
    <span class="ruby-identifier">parts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">part</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">in_extended_col</span>
        <span class="ruby-comment"># If we are continuing a previous column</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">part</span>[<span class="ruby-value">-1</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@quote_char</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">part</span>.<span class="ruby-identifier">count</span>(<span class="ruby-ivar">@quote_char</span>) <span class="ruby-operator">%</span> <span class="ruby-value">2</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
          <span class="ruby-comment"># extended column ends</span>
          <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">part</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>]
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">=~</span> <span class="ruby-ivar">@parsers</span>[<span class="ruby-value">:stray_quote</span>]
            <span class="ruby-identifier">raise</span> <span class="ruby-constant">MalformedCSVError</span>,
                  <span class="ruby-node">&quot;Missing or stray quote in line #{lineno + 1}&quot;</span>
          <span class="ruby-keyword">end</span>
          <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-ivar">@quote_char</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>, <span class="ruby-ivar">@quote_char</span>)
          <span class="ruby-identifier">in_extended_col</span> = <span class="ruby-keyword">false</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">part</span>
          <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@col_sep</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">part</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@quote_char</span>
        <span class="ruby-comment"># If we are staring a new quoted column</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">part</span>[<span class="ruby-value">-1</span>] <span class="ruby-operator">!=</span> <span class="ruby-ivar">@quote_char</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">part</span>.<span class="ruby-identifier">count</span>(<span class="ruby-ivar">@quote_char</span>) <span class="ruby-operator">%</span> <span class="ruby-value">2</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
          <span class="ruby-comment"># start an extended column</span>
          <span class="ruby-identifier">csv</span>             <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">part</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>]
          <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">last</span>        <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@col_sep</span>
          <span class="ruby-identifier">in_extended_col</span> =  <span class="ruby-keyword">true</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-comment"># regular quoted column</span>
          <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">part</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>]
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">=~</span> <span class="ruby-ivar">@parsers</span>[<span class="ruby-value">:stray_quote</span>]
            <span class="ruby-identifier">raise</span> <span class="ruby-constant">MalformedCSVError</span>,
                  <span class="ruby-node">&quot;Missing or stray quote in line #{lineno + 1}&quot;</span>
          <span class="ruby-keyword">end</span>
          <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-ivar">@quote_char</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>, <span class="ruby-ivar">@quote_char</span>)
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">part</span> <span class="ruby-operator">=~</span> <span class="ruby-ivar">@parsers</span>[<span class="ruby-value">:quote_or_nl</span>]
        <span class="ruby-comment"># Unquoted field with bad characters.</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">part</span> <span class="ruby-operator">=~</span> <span class="ruby-ivar">@parsers</span>[<span class="ruby-value">:nl_or_lf</span>]
          <span class="ruby-identifier">raise</span> <span class="ruby-constant">MalformedCSVError</span>, <span class="ruby-string">&quot;Unquoted fields do not allow &quot;</span> <span class="ruby-operator">+</span>
                                   <span class="ruby-node">&quot;\\r or \\n (line #{lineno + 1}).&quot;</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">raise</span> <span class="ruby-constant">MalformedCSVError</span>, <span class="ruby-node">&quot;Illegal quoting in line #{lineno + 1}.&quot;</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-comment"># Regular ole unquoted field.</span>
        <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">part</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">part</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># Replace tacked on @col_sep with @row_sep if we are still in an extended</span>
    <span class="ruby-comment"># column.</span>
    <span class="ruby-identifier">csv</span>[<span class="ruby-value">-1</span>][<span class="ruby-value">-1</span>] = <span class="ruby-ivar">@row_sep</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">in_extended_col</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">in_extended_col</span>
      <span class="ruby-comment"># if we're at eof?(), a quoted field wasn't closed...</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">eof?</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">MalformedCSVError</span>,
              <span class="ruby-node">&quot;Unclosed quoted field on line #{lineno + 1}.&quot;</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@field_size_limit</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@field_size_limit</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">MalformedCSVError</span>, <span class="ruby-node">&quot;Field size exceeded on line #{lineno + 1}.&quot;</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-comment"># otherwise, we need to loop and pull some more data to complete the row</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@lineno</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>

      <span class="ruby-comment"># save fields unconverted fields, if needed...</span>
      <span class="ruby-identifier">unconverted</span> = <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">dup</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@unconverted_fields</span>

      <span class="ruby-comment"># convert fields, if needed...</span>
      <span class="ruby-identifier">csv</span> = <span class="ruby-identifier">convert_fields</span>(<span class="ruby-identifier">csv</span>) <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@use_headers</span> <span class="ruby-keyword">or</span> <span class="ruby-ivar">@converters</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-comment"># parse out header rows and handle CSV::Row conversions...</span>
      <span class="ruby-identifier">csv</span> = <span class="ruby-identifier">parse_headers</span>(<span class="ruby-identifier">csv</span>)  <span class="ruby-keyword">if</span>     <span class="ruby-ivar">@use_headers</span>

      <span class="ruby-comment"># inject unconverted fields and accessor, if requested...</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@unconverted_fields</span> <span class="ruby-keyword">and</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:unconverted_fields</span>
        <span class="ruby-identifier">add_unconverted_fields</span>(<span class="ruby-identifier">csv</span>, <span class="ruby-identifier">unconverted</span>)
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># return the results</span>
      <span class="ruby-keyword">break</span> <span class="ruby-identifier">csv</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- shift-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="CSV.html#method-i-gets">gets</a>, <a href="CSV.html#method-i-readline">readline</a>
          </div>
          

          
        </div><!-- shift-method -->
      
        <div id="skip_blanks-3F-method" class="method-detail ">
          <a name="method-i-skip_blanks-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">skip_blanks?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Returns <code>true</code> blank lines are skipped by the parser. See <a
href="CSV.html#method-c-new">::new</a> for details.</p>
            

            
            <div class="method-source-code" id="skip_blanks-3F-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1668</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">skip_blanks?</span>()        <span class="ruby-ivar">@skip_blanks</span>        <span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- skip_blanks-3F-source -->
            
          </div>

          

          
        </div><!-- skip_blanks-3F-method -->
      
        <div id="unconverted_fields-3F-method" class="method-detail ">
          <a name="method-i-unconverted_fields-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">unconverted_fields?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Returns <code>true</code> if unconverted_fields() to parsed results.  See
<a href="CSV.html#method-c-new">::new</a> for details.</p>
            

            
            <div class="method-source-code" id="unconverted_fields-3F-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1637</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">unconverted_fields?</span>() <span class="ruby-ivar">@unconverted_fields</span> <span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- unconverted_fields-3F-source -->
            
          </div>

          

          
        </div><!-- unconverted_fields-3F-method -->
      
        <div id="write_headers-3F-method" class="method-detail ">
          <a name="method-i-write_headers-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">write_headers?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          
          <div>
  
            
            <p>Returns <code>true</code> if headers are written in output. See <a
href="CSV.html#method-c-new">::new</a> for details.</p>
            

            
            <div class="method-source-code" id="write_headers-3F-source">
              <pre> <!-- method.markup_code 290 -->
               <span class="ruby-comment"># File csv.rb, line 1652</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">write_headers?</span>()      <span class="ruby-ivar">@write_headers</span>      <span class="ruby-keyword">end</span>
            </pre> 
            </div><!-- write_headers-3F-source -->
            
          </div>

          

          
        </div><!-- write_headers-3F-method -->
      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  
  <div id='tx_CSV_versioned' class='associated_wrapper'></div><script type='text/javascript'>$("#tx_CSV_versioned").load("/associated/1.9.3/CSV.html");</script> <div id='tx_CSV' class='associated_wrapper'></div><script type='text/javascript'>$("#tx_CSV").load("/associated/CSV.html");</script> 
      
  </div><!-- documentation -->
  <div id='dynamic'>
  </div>
      
<div class='grids wrapper' id="footer">
  <p><small>This page was generated for Ruby 1.9.3</small></p> 
  
   <p><a href="http://www.ruby-doc.org">Ruby-doc.org</a> is provided by <a href="http://www.jamesbritt.com">James Britt</a> and <a href="http://www.neurogami.com">Neurogami</a>. <a href="http://www.neurogami.com">Hack your world.  Feed your head.  Live curious</a>.</p>
 
    <p><small>Generated with Ruby-doc Rdoc Generator 0.26.0</small>.</p>
  </div>
</div>
  
 <script type='text/javascript'>
$(document).ready(function() {
      $.ajaxSetup({ cache: false });
      $("#vulns-alert").load("/associated/vulns.html");
    });

    </script>


 
    <script type='text/javascript'>

  function loadPlus(plusdocs){
    var img_h = $("img.carbonad-image").css('height');
    //if(img_h != undefined) { //---
      $(plusdocs).find("div[class='associated_wrapper']").each (function() {
          $("#" + this.id).append($(plusdocs).find("#" + this.id ));
          });
    //} // ---
  } // end loadPlusdocs


$(document).ready(function() {
    $.ajaxSetup({ cache: false });
      $.get('/associated/1.9.3/plus_CSV.html', 
      function(plusdocs) {
      setTimeout(function() {
        loadPlus(plusdocs);
        }, 2000);
      }
      );
    });
</script>
		
</body>
</html>


